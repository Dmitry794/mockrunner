<?xml version="1.0"?>
<project name="mockrunner" default="release" basedir=".">

	<target name="init">
		
		<tstamp/>
		
        <property name="version" value="0.1"/>
        <property name="timestamp" value="${DSTAMP}-${TSTAMP}"/>
        
		<property name="build" value="build"/>
		<property name="src" value="src"/>
		<property name="doc" value="doc"/>
		<property name="bin" value="bin"/>
		<property name="lib" value="lib"/>
		
		<property name="releasedir" value="${bin}/mockrunner-${version}"/>
		<property name="releasefile" value="${bin}/mockrunner-${version}.zip"/>

		<filter token="version" value="${version}"/>
        <filter token="timestamp" value="${timestamp}"/>
		
		<path id="classpath">
            <pathelement location="${build}"/>
            <fileset dir="${lib}">
                <include name="*.jar"/>
            </fileset>
        </path>
		
	</target>
		
	<target name="compile" depends="init">	
		<mkdir dir="${build}"/>
		<javac srcdir="${src}" destdir="${build}" nowarn="true">
		 	<classpath>
                <path refid="classpath"/>
            </classpath>
		</javac>
	</target>

	<target name="jar" depends="compile">
		<delete file="${build}/mockrunner.jar"/>
		<jar jarfile="${build}/mockrunner.jar">
			<fileset dir="${build}"/>
			<fileset dir="${basedir}">
				<include name="LICENSE*.txt"/>
			</fileset>
		</jar>
	</target>
	
	<target name="javadoc" depends="init">
		<mkdir dir="${doc}/api"/>
        <javadoc destdir="${doc}/api"
           		 author="true"
           		 version="true"
           		 use="true"
           		 classpathref="classpath"
           		 windowtitle="Mockrunner">

			    <fileset dir="${src}" defaultexcludes="yes">
			    	<include name="com/mockrunner/**" />
			    	<exclude name="com/mockrunner/test/**" />
			    </fileset>

    			<doctitle><![CDATA[<h1>Mockrunner</h1>]]></doctitle>
  		</javadoc>
    </target>
	
	<target name="release" depends="clean,jar,javadoc">
		<mkdir dir="${releasedir}"/>
		<mkdir dir="${releasedir}/src"/>
		<mkdir dir="${releasedir}/doc"/>
		<delete file="${releasefile}"/>
		<copy todir="${releasedir}" filtering="true">
    		<fileset dir="${basedir}">
				<include name="*.txt"/>
			</fileset>	
  		</copy>
  		<copy todir="${releasedir}/src">
  			<fileset dir="${src}">
				<include name="**/*"/>
			</fileset>
  		</copy>
  		<copy todir="${releasedir}/doc">
  			<fileset dir="${doc}">
				<include name="**/*"/>
			</fileset>
  		</copy>
  		<copy todir="${releasedir}" file="${build}/mockrunner.jar"/>
  		<zip destfile="${releasefile}" basedir="${bin}"/>
	</target>
	
	<target name="clean" depends="init">
		<delete dir="${bin}"/>
		<delete dir="${doc}"/>
        <delete dir="${build}"/>
	</target>

</project>